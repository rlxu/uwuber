'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = undefined;

var _extends2 = require('babel-runtime/helpers/extends');

var _extends3 = _interopRequireDefault(_extends2);

var _defineProperty2 = require('babel-runtime/helpers/defineProperty');

var _defineProperty3 = _interopRequireDefault(_defineProperty2);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _taggedTemplateLiteral2 = require('babel-runtime/helpers/taggedTemplateLiteral');

var _taggedTemplateLiteral3 = _interopRequireDefault(_taggedTemplateLiteral2);

var _class, _temp;

var _templateObject = (0, _taggedTemplateLiteral3.default)(['\n  display: flex;\n  flex-direction: column;\n  background-color: ', ';\n  box-shadow: ', ';\n\n  :focus {\n    outline: 0;\n  }\n'], ['\n  display: flex;\n  flex-direction: column;\n  background-color: ', ';\n  box-shadow: ', ';\n\n  :focus {\n    outline: 0;\n  }\n']),
    _templateObject2 = (0, _taggedTemplateLiteral3.default)(['\n  padding: 8px;\n'], ['\n  padding: 8px;\n']),
    _templateObject3 = (0, _taggedTemplateLiteral3.default)(['\n  ', '\n  :hover {\n    cursor: pointer;\n    background-color: ', ';\n  }\n'], ['\n  ', '\n  :hover {\n    cursor: pointer;\n    background-color: ', ';\n  }\n']),
    _templateObject4 = (0, _taggedTemplateLiteral3.default)(['\n  position: absolute;\n  right: 15px;\n  top: 14px;\n  color: ', ';\n'], ['\n  position: absolute;\n  right: 15px;\n  top: 14px;\n  color: ', ';\n']); // Copyright (c) 2018 Uber Technologies, Inc.
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _propTypes = require('prop-types');

var _propTypes2 = _interopRequireDefault(_propTypes);

var _fuzzy = require('fuzzy');

var _fuzzy2 = _interopRequireDefault(_fuzzy);

var _classnames = require('classnames');

var _classnames2 = _interopRequireDefault(_classnames);

var _styledComponents = require('styled-components');

var _styledComponents2 = _interopRequireDefault(_styledComponents);

var _window = require('global/window');

var _accessor = require('./accessor');

var _accessor2 = _interopRequireDefault(_accessor);

var _keyevent = require('./keyevent');

var _keyevent2 = _interopRequireDefault(_keyevent);

var _dropdownList = require('./dropdown-list');

var _dropdownList2 = _interopRequireDefault(_dropdownList);

var _icons = require('../icons');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var DEFAULT_CLASS = 'typeahead';
/**
 * Copied mostly from 'react-typeahead', an auto-completing text input
 *
 * Renders an text input that shows options nearby that you can use the
 * keyboard or mouse to select.
 */

var TypeaheadWrapper = _styledComponents2.default.div(_templateObject, function (props) {
  return props.theme.dropdownListBgd;
}, function (props) {
  return props.theme.dropdownListShadow;
});

var InputBox = _styledComponents2.default.div(_templateObject2);

var TypeaheadInput = _styledComponents2.default.input(_templateObject3, function (props) {
  return props.theme.secondaryInput;
}, function (props) {
  return props.theme.secondaryInputBgd;
});

var InputIcon = _styledComponents2.default.div(_templateObject4, function (props) {
  return props.theme.inputPlaceholderColor;
});

var Typeahead = (_temp = _class = function (_Component) {
  (0, _inherits3.default)(Typeahead, _Component);

  function Typeahead(props) {
    (0, _classCallCheck3.default)(this, Typeahead);

    var _this = (0, _possibleConstructorReturn3.default)(this, (Typeahead.__proto__ || Object.getPrototypeOf(Typeahead)).call(this, props));

    _this._onOptionSelected = function (option, event) {
      if (_this.props.searchable) {
        // reset entry input
        _this.setState({
          searchResults: _this.getOptionsForValue('', _this.props.options),
          selection: '',
          entryValue: ''
        });
      }

      return _this.props.onOptionSelected(option, event);
    };

    _this._onTextEntryUpdated = function () {
      if (_this.props.searchable) {
        var value = _this.entry.value;

        _this.setState({
          searchResults: _this.getOptionsForValue(value, _this.props.options),
          selection: '',
          entryValue: value
        });
      }
    };

    _this._onEnter = function (event) {
      var selection = _this.getSelection();
      if (!selection) {
        return _this.props.onKeyDown(event);
      }
      return _this._onOptionSelected(selection, event);
    };

    _this.navDown = function () {
      _this._nav(1);
    };

    _this.navUp = function () {
      _this._nav(-1);
    };

    _this._onChange = function (event) {
      if (_this.props.onChange) {
        _this.props.onChange(event);
      }

      _this._onTextEntryUpdated();
    };

    _this._onKeyDown = function (event) {
      // If there are no visible elements, don't perform selector navigation.
      // Just pass this up to the upstream onKeydown handler.
      // Also skip if the user is pressing the shift key, since none of our handlers are looking for shift
      if (!_this._hasHint() || event.shiftKey) {
        return _this.props.onKeyDown(event);
      }

      var handler = _this.eventMap()[event.keyCode];

      if (handler) {
        handler(event);
      } else {
        return _this.props.onKeyDown(event);
      }
      // Don't propagate the keystroke back to the DOM/browser
      event.preventDefault();
    };

    _this._onFocus = function (event) {
      _this.setState({ isFocused: true });
      if (_this.props.onFocus) {
        return _this.props.onFocus(event);
      }
    };

    _this._onBlur = function (event) {
      _this.setState({ isFocused: false });
      if (_this.props.onBlur) {
        return _this.props.onBlur(event);
      }
    };

    _this.state = {
      searchResults: _this.getOptionsForValue(_this.props.initialValue, _this.props.options),

      // This should be called something else, 'entryValue'
      entryValue: _this.props.value || _this.props.initialValue,

      // A valid typeahead value
      selection: _this.props.value,

      // Index of the selection
      selectionIndex: null,

      // Keep track of the focus state of the input element, to determine
      // whether to show options when empty (if showOptionsWhenEmpty is true)
      isFocused: false
    };
    return _this;
  }

  (0, _createClass3.default)(Typeahead, [{
    key: 'componentDidMount',
    value: function componentDidMount() {
      this.setState({
        searchResults: this.getOptionsForValue('', this.props.options)
      });

      // call focus on entry or div to trigger key events listener
      if (this.entry) {
        this.entry.focus();
      } else {
        this.root.focus();
      }
    }
  }, {
    key: 'componentWillReceiveProps',
    value: function componentWillReceiveProps(nextProps) {
      var searchResults = this.getOptionsForValue(this.state.entryValue, nextProps.options);

      this.setState({ searchResults: searchResults });
    }
  }, {
    key: '_shouldSkipSearch',
    value: function _shouldSkipSearch(input) {
      var emptyValue = !input || input.trim().length === 0;

      // this.state must be checked because it may not be defined yet if this function
      // is called from within getInitialState
      var isFocused = this.state && this.state.isFocused;
      return !(this.props.showOptionsWhenEmpty && isFocused) && emptyValue;
    }
  }, {
    key: 'getOptionsForValue',
    value: function getOptionsForValue(value, options) {
      if (!this.props.searchable) {
        // directly pass through options if can not be searched
        return options;
      }
      if (this._shouldSkipSearch(value)) {
        return options;
      }

      var searchOptions = this._generateSearchFunction();
      return searchOptions(value, options);
    }
  }, {
    key: 'focus',
    value: function focus() {
      if (this.entry) {
        this.entry.focus();
      }
    }
  }, {
    key: '_hasCustomValue',
    value: function _hasCustomValue() {
      return this.props.allowCustomValues > 0 && this.state.entryValue.length >= this.props.allowCustomValues && this.state.searchResults.indexOf(this.state.entryValue) < 0;
    }
  }, {
    key: '_getCustomValue',
    value: function _getCustomValue() {
      return this._hasCustomValue() ? this.state.entryValue : null;
    }
  }, {
    key: '_renderIncrementalSearchResults',
    value: function _renderIncrementalSearchResults() {
      return _react2.default.createElement(this.props.customListComponent, {
        ref: 'sel',
        fixedOptions: this.props.fixedOptions,
        options: this.props.maxVisible ? this.state.searchResults.slice(0, this.props.maxVisible) : this.state.searchResults,
        areResultsTruncated: this.props.maxVisible && this.state.searchResults.length > this.props.maxVisible,
        resultsTruncatedMessage: this.props.resultsTruncatedMessage,
        onOptionSelected: this._onOptionSelected,
        allowCustomValues: this.props.allowCustomValues,
        customValue: this._getCustomValue(),
        customClasses: this.props.customClasses,
        customListItemComponent: this.props.customListItemComponent,
        customListHeaderComponent: this.props.customListHeaderComponent,
        selectionIndex: this.state.selectionIndex,
        defaultClassNames: this.props.defaultClassNames,
        displayOption: this.props.displayOption,
        selectedItems: this.props.selectedItems
      });
    }
  }, {
    key: 'getSelection',
    value: function getSelection() {
      var index = this.state.selectionIndex;

      if (this._hasCustomValue()) {
        if (index === 0) {
          return this.state.entryValue;
        }
        index--;
      }
      if (this._hasFixedOptions()) {
        return index < this.props.fixedOptions.length ? this.props.fixedOptions[index] : this.state.searchResults[index - this.props.fixedOptions.length];
      }
      return this.state.searchResults[index];
    }

    // use () => {} to avoid binding 'this'

  }, {
    key: '_onEscape',
    value: function _onEscape() {
      this.setState({
        selectionIndex: null
      });
    }
  }, {
    key: '_onTab',
    value: function _onTab(event) {
      var selection = this.getSelection();
      var option = selection ? selection : this.state.searchResults.length > 0 ? this.state.searchResults[0] : null;

      if (option === null && this._hasCustomValue()) {
        option = this._getCustomValue();
      }

      if (option !== null) {
        return this._onOptionSelected(option, event);
      }
    }
  }, {
    key: 'eventMap',
    value: function eventMap(event) {
      var events = {};

      events[_keyevent2.default.DOM_VK_UP] = this.navUp;
      events[_keyevent2.default.DOM_VK_DOWN] = this.navDown;
      events[_keyevent2.default.DOM_VK_RETURN] = events[_keyevent2.default.DOM_VK_ENTER] = this._onEnter;
      events[_keyevent2.default.DOM_VK_ESCAPE] = this._onEscape;
      events[_keyevent2.default.DOM_VK_TAB] = this._onTab;

      return events;
    }
  }, {
    key: '_nav',
    value: function _nav(delta) {
      if (!this._hasHint()) {
        return;
      }
      var newIndex = this.state.selectionIndex === null ? delta === 1 ? 0 : delta : this.state.selectionIndex + delta;
      var length = this.props.maxVisible ? this.state.searchResults.slice(0, this.props.maxVisible).length : this.state.searchResults.length;
      if (this._hasCustomValue()) {
        length += 1;
      }

      if (newIndex < 0) {
        newIndex += length;
      } else if (newIndex >= length) {
        newIndex -= length;
      }

      this.setState({ selectionIndex: newIndex });
    }
  }, {
    key: '_renderHiddenInput',
    value: function _renderHiddenInput() {
      if (!this.props.name) {
        return null;
      }

      return _react2.default.createElement('input', {
        type: 'hidden',
        name: this.props.name,
        value: this.state.selection
      });
    }
  }, {
    key: '_generateSearchFunction',
    value: function _generateSearchFunction() {
      var searchOptionsProp = this.props.searchOptions;
      var filterOptionProp = this.props.filterOption;
      if (typeof searchOptionsProp === 'function') {
        if (filterOptionProp !== null) {
          _window.console.warn('searchOptions prop is being used, filterOption prop will be ignored');
        }
        return searchOptionsProp;
      } else if (typeof filterOptionProp === 'function') {
        // use custom filter option
        return function (value, options) {
          return options.filter(function (o) {
            return filterOptionProp(value, o);
          });
        };
      }

      var mapper = typeof filterOptionProp === 'string' ? _accessor2.default.generateAccessor(filterOptionProp) : _accessor2.default.IDENTITY_FN;

      return function (value, options) {
        return _fuzzy2.default.filter(value, options, { extract: mapper }).map(function (res) {
          return options[res.index];
        });
      };
    }
  }, {
    key: '_hasHint',
    value: function _hasHint() {
      return this.state.searchResults.length > 0 || this._hasCustomValue();
    }
  }, {
    key: '_hasFixedOptions',
    value: function _hasFixedOptions() {
      return Array.isArray(this.props.fixedOptions) && this.props.fixedOptions.length;
    }
  }, {
    key: 'render',
    value: function render() {
      var _this2 = this;

      var inputClasses = {};
      inputClasses[this.props.customClasses.input] = Boolean(this.props.customClasses.input);
      var inputClassList = (0, _classnames2.default)(inputClasses);

      var classes = (0, _defineProperty3.default)({}, DEFAULT_CLASS, this.props.defaultClassNames);
      classes[this.props.className] = Boolean(this.props.className);
      var classList = (0, _classnames2.default)(classes);

      return _react2.default.createElement(
        TypeaheadWrapper,
        {
          className: classList,
          innerRef: function innerRef(comp) {
            _this2.root = comp;
          },
          tabIndex: '0',
          onKeyDown: this._onKeyDown,
          onKeyPress: this.props.onKeyPress,
          onKeyUp: this.props.onKeyUp,
          onFocus: this._onFocus
        },
        this._renderHiddenInput(),
        this.props.searchable ? _react2.default.createElement(
          InputBox,
          null,
          _react2.default.createElement(TypeaheadInput, (0, _extends3.default)({
            innerRef: function innerRef(comp) {
              _this2.entry = comp;
            },
            type: 'text',
            disabled: this.props.disabled
          }, this.props.inputProps, {
            placeholder: this.props.placeholder,
            className: inputClassList,
            value: this.state.entryValue,
            onChange: this._onChange,
            onBlur: this._onBlur
          })),
          _react2.default.createElement(
            InputIcon,
            null,
            _react2.default.createElement(_icons.Search, { height: '18px' })
          )
        ) : null,
        this._renderIncrementalSearchResults()
      );
    }
  }]);
  return Typeahead;
}(_react.Component), _class.propTypes = {
  name: _propTypes2.default.string,
  customClasses: _propTypes2.default.object,
  maxVisible: _propTypes2.default.number,
  resultsTruncatedMessage: _propTypes2.default.string,
  options: _propTypes2.default.arrayOf(_propTypes2.default.any),
  fixedOptions: _propTypes2.default.arrayOf(_propTypes2.default.any),
  allowCustomValues: _propTypes2.default.number,
  initialValue: _propTypes2.default.string,
  value: _propTypes2.default.string,
  placeholder: _propTypes2.default.string,
  disabled: _propTypes2.default.bool,
  textarea: _propTypes2.default.bool,
  inputProps: _propTypes2.default.object,
  onOptionSelected: _propTypes2.default.func,
  onChange: _propTypes2.default.func,
  onKeyDown: _propTypes2.default.func,
  onKeyPress: _propTypes2.default.func,
  onKeyUp: _propTypes2.default.func,
  onFocus: _propTypes2.default.func,
  onBlur: _propTypes2.default.func,
  filterOption: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.func]),
  searchOptions: _propTypes2.default.func,
  displayOption: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.func]),
  inputDisplayOption: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.func]),
  formInputOption: _propTypes2.default.oneOfType([_propTypes2.default.string, _propTypes2.default.func]),
  defaultClassNames: _propTypes2.default.bool,
  customListComponent: _propTypes2.default.oneOfType([_propTypes2.default.element, _propTypes2.default.func]),
  customListItemComponent: _propTypes2.default.oneOfType([_propTypes2.default.element, _propTypes2.default.func]),
  customListHeaderComponent: _propTypes2.default.oneOfType([_propTypes2.default.element, _propTypes2.default.func]),
  showOptionsWhenEmpty: _propTypes2.default.bool,
  searchable: _propTypes2.default.bool
}, _class.defaultProps = {
  options: [],
  customClasses: {},
  allowCustomValues: 0,
  initialValue: '',
  value: '',
  placeholder: '',
  disabled: false,
  textarea: false,
  inputProps: {},
  onOptionSelected: function onOptionSelected(option) {},
  onChange: function onChange(event) {},
  onKeyDown: function onKeyDown(event) {},
  onKeyPress: function onKeyPress(event) {},
  onKeyUp: function onKeyUp(event) {},
  onFocus: function onFocus(event) {},
  onBlur: function onBlur(event) {},

  filterOption: null,
  searchOptions: null,
  inputDisplayOption: null,
  defaultClassNames: true,
  customListComponent: _dropdownList2.default,
  customListItemComponent: _dropdownList.ListItem,
  customListHeaderComponent: null,
  showOptionsWhenEmpty: true,
  searchable: true,
  resultsTruncatedMessage: null
}, _temp);
exports.default = Typeahead;
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL2NvbW1vbi9pdGVtLXNlbGVjdG9yL3R5cGVhaGVhZC5qcyJdLCJuYW1lcyI6WyJERUZBVUxUX0NMQVNTIiwiVHlwZWFoZWFkV3JhcHBlciIsInN0eWxlZCIsImRpdiIsInByb3BzIiwidGhlbWUiLCJkcm9wZG93bkxpc3RCZ2QiLCJkcm9wZG93bkxpc3RTaGFkb3ciLCJJbnB1dEJveCIsIlR5cGVhaGVhZElucHV0IiwiaW5wdXQiLCJzZWNvbmRhcnlJbnB1dCIsInNlY29uZGFyeUlucHV0QmdkIiwiSW5wdXRJY29uIiwiaW5wdXRQbGFjZWhvbGRlckNvbG9yIiwiVHlwZWFoZWFkIiwiX29uT3B0aW9uU2VsZWN0ZWQiLCJvcHRpb24iLCJldmVudCIsInNlYXJjaGFibGUiLCJzZXRTdGF0ZSIsInNlYXJjaFJlc3VsdHMiLCJnZXRPcHRpb25zRm9yVmFsdWUiLCJvcHRpb25zIiwic2VsZWN0aW9uIiwiZW50cnlWYWx1ZSIsIm9uT3B0aW9uU2VsZWN0ZWQiLCJfb25UZXh0RW50cnlVcGRhdGVkIiwidmFsdWUiLCJlbnRyeSIsIl9vbkVudGVyIiwiZ2V0U2VsZWN0aW9uIiwib25LZXlEb3duIiwibmF2RG93biIsIl9uYXYiLCJuYXZVcCIsIl9vbkNoYW5nZSIsIm9uQ2hhbmdlIiwiX29uS2V5RG93biIsIl9oYXNIaW50Iiwic2hpZnRLZXkiLCJoYW5kbGVyIiwiZXZlbnRNYXAiLCJrZXlDb2RlIiwicHJldmVudERlZmF1bHQiLCJfb25Gb2N1cyIsImlzRm9jdXNlZCIsIm9uRm9jdXMiLCJfb25CbHVyIiwib25CbHVyIiwic3RhdGUiLCJpbml0aWFsVmFsdWUiLCJzZWxlY3Rpb25JbmRleCIsImZvY3VzIiwicm9vdCIsIm5leHRQcm9wcyIsImVtcHR5VmFsdWUiLCJ0cmltIiwibGVuZ3RoIiwic2hvd09wdGlvbnNXaGVuRW1wdHkiLCJfc2hvdWxkU2tpcFNlYXJjaCIsInNlYXJjaE9wdGlvbnMiLCJfZ2VuZXJhdGVTZWFyY2hGdW5jdGlvbiIsImFsbG93Q3VzdG9tVmFsdWVzIiwiaW5kZXhPZiIsIl9oYXNDdXN0b21WYWx1ZSIsImZpeGVkT3B0aW9ucyIsIm1heFZpc2libGUiLCJzbGljZSIsInJlc3VsdHNUcnVuY2F0ZWRNZXNzYWdlIiwiX2dldEN1c3RvbVZhbHVlIiwiY3VzdG9tQ2xhc3NlcyIsImN1c3RvbUxpc3RJdGVtQ29tcG9uZW50IiwiY3VzdG9tTGlzdEhlYWRlckNvbXBvbmVudCIsImRlZmF1bHRDbGFzc05hbWVzIiwiZGlzcGxheU9wdGlvbiIsInNlbGVjdGVkSXRlbXMiLCJpbmRleCIsIl9oYXNGaXhlZE9wdGlvbnMiLCJldmVudHMiLCJLZXlFdmVudCIsIkRPTV9WS19VUCIsIkRPTV9WS19ET1dOIiwiRE9NX1ZLX1JFVFVSTiIsIkRPTV9WS19FTlRFUiIsIkRPTV9WS19FU0NBUEUiLCJfb25Fc2NhcGUiLCJET01fVktfVEFCIiwiX29uVGFiIiwiZGVsdGEiLCJuZXdJbmRleCIsIm5hbWUiLCJzZWFyY2hPcHRpb25zUHJvcCIsImZpbHRlck9wdGlvblByb3AiLCJmaWx0ZXJPcHRpb24iLCJDb25zb2xlIiwid2FybiIsImZpbHRlciIsIm8iLCJtYXBwZXIiLCJBY2Nlc3NvciIsImdlbmVyYXRlQWNjZXNzb3IiLCJJREVOVElUWV9GTiIsImZ1enp5IiwiZXh0cmFjdCIsIm1hcCIsInJlcyIsIkFycmF5IiwiaXNBcnJheSIsImlucHV0Q2xhc3NlcyIsIkJvb2xlYW4iLCJpbnB1dENsYXNzTGlzdCIsImNsYXNzZXMiLCJjbGFzc05hbWUiLCJjbGFzc0xpc3QiLCJjb21wIiwib25LZXlQcmVzcyIsIm9uS2V5VXAiLCJfcmVuZGVySGlkZGVuSW5wdXQiLCJkaXNhYmxlZCIsImlucHV0UHJvcHMiLCJwbGFjZWhvbGRlciIsIl9yZW5kZXJJbmNyZW1lbnRhbFNlYXJjaFJlc3VsdHMiLCJDb21wb25lbnQiLCJwcm9wVHlwZXMiLCJQcm9wVHlwZXMiLCJzdHJpbmciLCJvYmplY3QiLCJudW1iZXIiLCJhcnJheU9mIiwiYW55IiwiYm9vbCIsInRleHRhcmVhIiwiZnVuYyIsIm9uZU9mVHlwZSIsImlucHV0RGlzcGxheU9wdGlvbiIsImZvcm1JbnB1dE9wdGlvbiIsImN1c3RvbUxpc3RDb21wb25lbnQiLCJlbGVtZW50IiwiZGVmYXVsdFByb3BzIiwiRHJvcGRvd25MaXN0IiwiTGlzdEl0ZW0iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7dU5BQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOztBQUVBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBRUEsSUFBTUEsZ0JBQWdCLFdBQXRCO0FBQ0E7Ozs7Ozs7QUFPQSxJQUFNQyxtQkFBbUJDLDJCQUFPQyxHQUExQixrQkFHZ0I7QUFBQSxTQUFTQyxNQUFNQyxLQUFOLENBQVlDLGVBQXJCO0FBQUEsQ0FIaEIsRUFJVTtBQUFBLFNBQVNGLE1BQU1DLEtBQU4sQ0FBWUUsa0JBQXJCO0FBQUEsQ0FKVixDQUFOOztBQVdBLElBQU1DLFdBQVdOLDJCQUFPQyxHQUFsQixrQkFBTjs7QUFJQSxJQUFNTSxpQkFBaUJQLDJCQUFPUSxLQUF4QixtQkFDRjtBQUFBLFNBQVNOLE1BQU1DLEtBQU4sQ0FBWU0sY0FBckI7QUFBQSxDQURFLEVBSWtCO0FBQUEsU0FBU1AsTUFBTUMsS0FBTixDQUFZTyxpQkFBckI7QUFBQSxDQUpsQixDQUFOOztBQVFBLElBQU1DLFlBQVlYLDJCQUFPQyxHQUFuQixtQkFJSztBQUFBLFNBQVNDLE1BQU1DLEtBQU4sQ0FBWVMscUJBQXJCO0FBQUEsQ0FKTCxDQUFOOztJQU9xQkMsUzs7O0FBc0VuQixxQkFBWVgsS0FBWixFQUFtQjtBQUFBOztBQUFBLG9JQUNYQSxLQURXOztBQUFBLFVBb0luQlksaUJB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QWhCSTs7QUFpQnBCNEUsZ0JBQWMsSUFqQk07QUFrQnBCakMsaUJBQWUsSUFsQks7QUFtQnBCMEUsc0JBQW9CLElBbkJBO0FBb0JwQjdELHFCQUFtQixJQXBCQztBQXFCcEIrRCx1QkFBcUJHLHNCQXJCRDtBQXNCcEJwRSwyQkFBeUJxRSxzQkF0Qkw7QUF1QnBCcEUsNkJBQTJCLElBdkJQO0FBd0JwQmQsd0JBQXNCLElBeEJGO0FBeUJwQnhDLGNBQVksSUF6QlE7QUEwQnBCa0QsMkJBQXlCO0FBMUJMLEM7a0JBekNIdEQsUztBQSticEIiLCJmaWxlIjoidHlwZWFoZWFkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSAyMDE4IFViZXIgVGVjaG5vbG9naWVzLCBJbmMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4vLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4vLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4vLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbi8vIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbi8vIFRIRSBTT0ZUV0FSRS5cblxuaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50fSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IGZ1enp5IGZyb20gJ2Z1enp5JztcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IHN0eWxlZCBmcm9tICdzdHlsZWQtY29tcG9uZW50cyc7XG5pbXBvcnQge2NvbnNvbGUgYXMgQ29uc29sZX0gZnJvbSAnZ2xvYmFsL3dpbmRvdyc7XG5cbmltcG9ydCBBY2Nlc3NvciBmcm9tICcuL2FjY2Vzc29yJztcbmltcG9ydCBLZXlFdmVudCBmcm9tICcuL2tleWV2ZW50JztcbmltcG9ydCBEcm9wZG93bkxpc3QsIHtMaXN0SXRlbX0gZnJvbSAnLi9kcm9wZG93bi1saXN0JztcbmltcG9ydCB7U2VhcmNofSBmcm9tICdjb21wb25lbnRzL2NvbW1vbi9pY29ucyc7XG5cbmNvbnN0IERFRkFVTFRfQ0xBU1MgPSAndHlwZWFoZWFkJztcbi8qKlxuICogQ29waWVkIG1vc3RseSBmcm9tICdyZWFjdC10eXBlYWhlYWQnLCBhbiBhdXRvLWNvbXBsZXRpbmcgdGV4dCBpbnB1dFxuICpcbiAqIFJlbmRlcnMgYW4gdGV4dCBpbnB1dCB0aGF0IHNob3dzIG9wdGlvbnMgbmVhcmJ5IHRoYXQgeW91IGNhbiB1c2UgdGhlXG4gKiBrZXlib2FyZCBvciBtb3VzZSB0byBzZWxlY3QuXG4gKi9cblxuY29uc3QgVHlwZWFoZWFkV3JhcHBlciA9IHN0eWxlZC5kaXZgXG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIGJhY2tncm91bmQtY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUuZHJvcGRvd25MaXN0QmdkfTtcbiAgYm94LXNoYWRvdzogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5kcm9wZG93bkxpc3RTaGFkb3d9O1xuXG4gIDpmb2N1cyB7XG4gICAgb3V0bGluZTogMDtcbiAgfVxuYDtcblxuY29uc3QgSW5wdXRCb3ggPSBzdHlsZWQuZGl2YFxuICBwYWRkaW5nOiA4cHg7XG5gO1xuXG5jb25zdCBUeXBlYWhlYWRJbnB1dCA9IHN0eWxlZC5pbnB1dGBcbiAgJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5zZWNvbmRhcnlJbnB1dH1cbiAgOmhvdmVyIHtcbiAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5zZWNvbmRhcnlJbnB1dEJnZH07XG4gIH1cbmA7XG5cbmNvbnN0IElucHV0SWNvbiA9IHN0eWxlZC5kaXZgXG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgcmlnaHQ6IDE1cHg7XG4gIHRvcDogMTRweDtcbiAgY29sb3I6ICR7cHJvcHMgPT4gcHJvcHMudGhlbWUuaW5wdXRQbGFjZWhvbGRlckNvbG9yfTtcbmA7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFR5cGVhaGVhZCBleHRlbmRzIENvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgbmFtZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBjdXN0b21DbGFzc2VzOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIG1heFZpc2libGU6IFByb3BUeXBlcy5udW1iZXIsXG4gICAgcmVzdWx0c1RydW5jYXRlZE1lc3NhZ2U6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgb3B0aW9uczogUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLmFueSksXG4gICAgZml4ZWRPcHRpb25zOiBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMuYW55KSxcbiAgICBhbGxvd0N1c3RvbVZhbHVlczogUHJvcFR5cGVzLm51bWJlcixcbiAgICBpbml0aWFsVmFsdWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgdmFsdWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgcGxhY2Vob2xkZXI6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgZGlzYWJsZWQ6IFByb3BUeXBlcy5ib29sLFxuICAgIHRleHRhcmVhOiBQcm9wVHlwZXMuYm9vbCxcbiAgICBpbnB1dFByb3BzOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIG9uT3B0aW9uU2VsZWN0ZWQ6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgICBvbktleURvd246IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uS2V5UHJlc3M6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uS2V5VXA6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uRm9jdXM6IFByb3BUeXBlcy5mdW5jLFxuICAgIG9uQmx1cjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgZmlsdGVyT3B0aW9uOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuc3RyaW5nLCBQcm9wVHlwZXMuZnVuY10pLFxuICAgIHNlYXJjaE9wdGlvbnM6IFByb3BUeXBlcy5mdW5jLFxuICAgIGRpc3BsYXlPcHRpb246IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5zdHJpbmcsIFByb3BUeXBlcy5mdW5jXSksXG4gICAgaW5wdXREaXNwbGF5T3B0aW9uOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuc3RyaW5nLCBQcm9wVHlwZXMuZnVuY10pLFxuICAgIGZvcm1JbnB1dE9wdGlvbjogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLnN0cmluZywgUHJvcFR5cGVzLmZ1bmNdKSxcbiAgICBkZWZhdWx0Q2xhc3NOYW1lczogUHJvcFR5cGVzLmJvb2wsXG4gICAgY3VzdG9tTGlzdENvbXBvbmVudDogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLmVsZW1lbnQsIFByb3BUeXBlcy5mdW5jXSksXG4gICAgY3VzdG9tTGlzdEl0ZW1Db21wb25lbnQ6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1xuICAgICAgUHJvcFR5cGVzLmVsZW1lbnQsXG4gICAgICBQcm9wVHlwZXMuZnVuY1xuICAgIF0pLFxuICAgIGN1c3RvbUxpc3RIZWFkZXJDb21wb25lbnQ6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1xuICAgICAgUHJvcFR5cGVzLmVsZW1lbnQsXG4gICAgICBQcm9wVHlwZXMuZnVuY1xuICAgIF0pLFxuICAgIHNob3dPcHRpb25zV2hlbkVtcHR5OiBQcm9wVHlwZXMuYm9vbCxcbiAgICBzZWFyY2hhYmxlOiBQcm9wVHlwZXMuYm9vbFxuICB9O1xuXG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgb3B0aW9uczogW10sXG4gICAgY3VzdG9tQ2xhc3Nlczoge30sXG4gICAgYWxsb3dDdXN0b21WYWx1ZXM6IDAsXG4gICAgaW5pdGlhbFZhbHVlOiAnJyxcbiAgICB2YWx1ZTogJycsXG4gICAgcGxhY2Vob2xkZXI6ICcnLFxuICAgIGRpc2FibGVkOiBmYWxzZSxcbiAgICB0ZXh0YXJlYTogZmFsc2UsXG4gICAgaW5wdXRQcm9wczoge30sXG4gICAgb25PcHRpb25TZWxlY3RlZChvcHRpb24pIHt9LFxuICAgIG9uQ2hhbmdlKGV2ZW50KSB7fSxcbiAgICBvbktleURvd24oZXZlbnQpIHt9LFxuICAgIG9uS2V5UHJlc3MoZXZlbnQpIHt9LFxuICAgIG9uS2V5VXAoZXZlbnQpIHt9LFxuICAgIG9uRm9jdXMoZXZlbnQpIHt9LFxuICAgIG9uQmx1cihldmVudCkge30sXG4gICAgZmlsdGVyT3B0aW9uOiBudWxsLFxuICAgIHNlYXJjaE9wdGlvbnM6IG51bGwsXG4gICAgaW5wdXREaXNwbGF5T3B0aW9uOiBudWxsLFxuICAgIGRlZmF1bHRDbGFzc05hbWVzOiB0cnVlLFxuICAgIGN1c3RvbUxpc3RDb21wb25lbnQ6IERyb3Bkb3duTGlzdCxcbiAgICBjdXN0b21MaXN0SXRlbUNvbXBvbmVudDogTGlzdEl0ZW0sXG4gICAgY3VzdG9tTGlzdEhlYWRlckNvbXBvbmVudDogbnVsbCxcbiAgICBzaG93T3B0aW9uc1doZW5FbXB0eTogdHJ1ZSxcbiAgICBzZWFyY2hhYmxlOiB0cnVlLFxuICAgIHJlc3VsdHNUcnVuY2F0ZWRNZXNzYWdlOiBudWxsXG4gIH07XG5cbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG5cbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgc2VhcmNoUmVzdWx0czogdGhpcy5nZXRPcHRpb25zRm9yVmFsdWUoXG4gICAgICAgIHRoaXMucHJvcHMuaW5pdGlhbFZhbHVlLFxuICAgICAgICB0aGlzLnByb3BzLm9wdGlvbnNcbiAgICAgICksXG5cbiAgICAgIC8vIFRoaXMgc2hvdWxkIGJlIGNhbGxlZCBzb21ldGhpbmcgZWxzZSwgJ2VudHJ5VmFsdWUnXG4gICAgICBlbnRyeVZhbHVlOiB0aGlzLnByb3BzLnZhbHVlIHx8IHRoaXMucHJvcHMuaW5pdGlhbFZhbHVlLFxuXG4gICAgICAvLyBBIHZhbGlkIHR5cGVhaGVhZCB2YWx1ZVxuICAgICAgc2VsZWN0aW9uOiB0aGlzLnByb3BzLnZhbHVlLFxuXG4gICAgICAvLyBJbmRleCBvZiB0aGUgc2VsZWN0aW9uXG4gICAgICBzZWxlY3Rpb25JbmRleDogbnVsbCxcblxuICAgICAgLy8gS2VlcCB0cmFjayBvZiB0aGUgZm9jdXMgc3RhdGUgb2YgdGhlIGlucHV0IGVsZW1lbnQsIHRvIGRldGVybWluZVxuICAgICAgLy8gd2hldGhlciB0byBzaG93IG9wdGlvbnMgd2hlbiBlbXB0eSAoaWYgc2hvd09wdGlvbnNXaGVuRW1wdHkgaXMgdHJ1ZSlcbiAgICAgIGlzRm9jdXNlZDogZmFsc2VcbiAgICB9O1xuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBzZWFyY2hSZXN1bHRzOiB0aGlzLmdldE9wdGlvbnNGb3JWYWx1ZSgnJywgdGhpcy5wcm9wcy5vcHRpb25zKVxuICAgIH0pO1xuXG4gICAgLy8gY2FsbCBmb2N1cyBvbiBlbnRyeSBvciBkaXYgdG8gdHJpZ2dlciBrZXkgZXZlbnRzIGxpc3RlbmVyXG4gICAgaWYgKHRoaXMuZW50cnkpIHtcbiAgICAgIHRoaXMuZW50cnkuZm9jdXMoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yb290LmZvY3VzKCk7XG4gICAgfVxuICB9XG5cbiAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMpIHtcbiAgICBjb25zdCBzZWFyY2hSZXN1bHRzID0gdGhpcy5nZXRPcHRpb25zRm9yVmFsdWUoXG4gICAgICB0aGlzLnN0YXRlLmVudHJ5VmFsdWUsXG4gICAgICBuZXh0UHJvcHMub3B0aW9uc1xuICAgICk7XG5cbiAgICB0aGlzLnNldFN0YXRlKHtzZWFyY2hSZXN1bHRzfSk7XG4gIH1cblxuICBfc2hvdWxkU2tpcFNlYXJjaChpbnB1dCkge1xuICAgIGNvbnN0IGVtcHR5VmFsdWUgPSAhaW5wdXQgfHwgaW5wdXQudHJpbSgpLmxlbmd0aCA9PT0gMDtcblxuICAgIC8vIHRoaXMuc3RhdGUgbXVzdCBiZSBjaGVja2VkIGJlY2F1c2UgaXQgbWF5IG5vdCBiZSBkZWZpbmVkIHlldCBpZiB0aGlzIGZ1bmN0aW9uXG4gICAgLy8gaXMgY2FsbGVkIGZyb20gd2l0aGluIGdldEluaXRpYWxTdGF0ZVxuICAgIGNvbnN0IGlzRm9jdXNlZCA9IHRoaXMuc3RhdGUgJiYgdGhpcy5zdGF0ZS5pc0ZvY3VzZWQ7XG4gICAgcmV0dXJuICEodGhpcy5wcm9wcy5zaG93T3B0aW9uc1doZW5FbXB0eSAmJiBpc0ZvY3VzZWQpICYmIGVtcHR5VmFsdWU7XG4gIH1cblxuICBnZXRPcHRpb25zRm9yVmFsdWUodmFsdWUsIG9wdGlvbnMpIHtcbiAgICBpZiAoIXRoaXMucHJvcHMuc2VhcmNoYWJsZSkge1xuICAgICAgLy8gZGlyZWN0bHkgcGFzcyB0aHJvdWdoIG9wdGlvbnMgaWYgY2FuIG5vdCBiZSBzZWFyY2hlZFxuICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgfVxuICAgIGlmICh0aGlzLl9zaG91bGRTa2lwU2VhcmNoKHZhbHVlKSkge1xuICAgICAgcmV0dXJuIG9wdGlvbnM7XG4gICAgfVxuXG4gICAgY29uc3Qgc2VhcmNoT3B0aW9ucyA9IHRoaXMuX2dlbmVyYXRlU2VhcmNoRnVuY3Rpb24oKTtcbiAgICByZXR1cm4gc2VhcmNoT3B0aW9ucyh2YWx1ZSwgb3B0aW9ucyk7XG4gIH1cblxuICBmb2N1cygpIHtcbiAgICBpZiAodGhpcy5lbnRyeSkge1xuICAgICAgdGhpcy5lbnRyeS5mb2N1cygpO1xuICAgIH1cbiAgfVxuXG4gIF9oYXNDdXN0b21WYWx1ZSgpIHtcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5wcm9wcy5hbGxvd0N1c3RvbVZhbHVlcyA+IDAgJiZcbiAgICAgIHRoaXMuc3RhdGUuZW50cnlWYWx1ZS5sZW5ndGggPj0gdGhpcy5wcm9wcy5hbGxvd0N1c3RvbVZhbHVlcyAmJlxuICAgICAgdGhpcy5zdGF0ZS5zZWFyY2hSZXN1bHRzLmluZGV4T2YodGhpcy5zdGF0ZS5lbnRyeVZhbHVlKSA8IDBcbiAgICApO1xuICB9XG5cbiAgX2dldEN1c3RvbVZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLl9oYXNDdXN0b21WYWx1ZSgpID8gdGhpcy5zdGF0ZS5lbnRyeVZhbHVlIDogbnVsbDtcbiAgfVxuXG4gIF9yZW5kZXJJbmNyZW1lbnRhbFNlYXJjaFJlc3VsdHMoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDx0aGlzLnByb3BzLmN1c3RvbUxpc3RDb21wb25lbnRcbiAgICAgICAgcmVmPVwic2VsXCJcbiAgICAgICAgZml4ZWRPcHRpb25zPXt0aGlzLnByb3BzLmZpeGVkT3B0aW9uc31cbiAgICAgICAgb3B0aW9ucz17XG4gICAgICAgICAgdGhpcy5wcm9wcy5tYXhWaXNpYmxlXG4gICAgICAgICAgICA/IHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0cy5zbGljZSgwLCB0aGlzLnByb3BzLm1heFZpc2libGUpXG4gICAgICAgICAgICA6IHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0c1xuICAgICAgICB9XG4gICAgICAgIGFyZVJlc3VsdHNUcnVuY2F0ZWQ9e1xuICAgICAgICAgIHRoaXMucHJvcHMubWF4VmlzaWJsZSAmJlxuICAgICAgICAgIHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0cy5sZW5ndGggPiB0aGlzLnByb3BzLm1heFZpc2libGVcbiAgICAgICAgfVxuICAgICAgICByZXN1bHRzVHJ1bmNhdGVkTWVzc2FnZT17dGhpcy5wcm9wcy5yZXN1bHRzVHJ1bmNhdGVkTWVzc2FnZX1cbiAgICAgICAgb25PcHRpb25TZWxlY3RlZD17dGhpcy5fb25PcHRpb25TZWxlY3RlZH1cbiAgICAgICAgYWxsb3dDdXN0b21WYWx1ZXM9e3RoaXMucHJvcHMuYWxsb3dDdXN0b21WYWx1ZXN9XG4gICAgICAgIGN1c3RvbVZhbHVlPXt0aGlzLl9nZXRDdXN0b21WYWx1ZSgpfVxuICAgICAgICBjdXN0b21DbGFzc2VzPXt0aGlzLnByb3BzLmN1c3RvbUNsYXNzZXN9XG4gICAgICAgIGN1c3RvbUxpc3RJdGVtQ29tcG9uZW50PXt0aGlzLnByb3BzLmN1c3RvbUxpc3RJdGVtQ29tcG9uZW50fVxuICAgICAgICBjdXN0b21MaXN0SGVhZGVyQ29tcG9uZW50PXt0aGlzLnByb3BzLmN1c3RvbUxpc3RIZWFkZXJDb21wb25lbnR9XG4gICAgICAgIHNlbGVjdGlvbkluZGV4PXt0aGlzLnN0YXRlLnNlbGVjdGlvbkluZGV4fVxuICAgICAgICBkZWZhdWx0Q2xhc3NOYW1lcz17dGhpcy5wcm9wcy5kZWZhdWx0Q2xhc3NOYW1lc31cbiAgICAgICAgZGlzcGxheU9wdGlvbj17dGhpcy5wcm9wcy5kaXNwbGF5T3B0aW9ufVxuICAgICAgICBzZWxlY3RlZEl0ZW1zPXt0aGlzLnByb3BzLnNlbGVjdGVkSXRlbXN9XG4gICAgICAvPlxuICAgICk7XG4gIH1cblxuICBnZXRTZWxlY3Rpb24oKSB7XG4gICAgbGV0IGluZGV4ID0gdGhpcy5zdGF0ZS5zZWxlY3Rpb25JbmRleDtcblxuICAgIGlmICh0aGlzLl9oYXNDdXN0b21WYWx1ZSgpKSB7XG4gICAgICBpZiAoaW5kZXggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhdGUuZW50cnlWYWx1ZTtcbiAgICAgIH1cbiAgICAgIGluZGV4LS07XG4gICAgfVxuICAgIGlmICh0aGlzLl9oYXNGaXhlZE9wdGlvbnMoKSkge1xuICAgICAgcmV0dXJuIGluZGV4IDwgdGhpcy5wcm9wcy5maXhlZE9wdGlvbnMubGVuZ3RoXG4gICAgICAgID8gdGhpcy5wcm9wcy5maXhlZE9wdGlvbnNbaW5kZXhdXG4gICAgICAgIDogdGhpcy5zdGF0ZS5zZWFyY2hSZXN1bHRzW2luZGV4IC0gdGhpcy5wcm9wcy5maXhlZE9wdGlvbnMubGVuZ3RoXTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0c1tpbmRleF07XG4gIH1cblxuICBfb25PcHRpb25TZWxlY3RlZCA9IChvcHRpb24sIGV2ZW50KSA9PiB7XG4gICAgaWYgKHRoaXMucHJvcHMuc2VhcmNoYWJsZSkge1xuICAgICAgLy8gcmVzZXQgZW50cnkgaW5wdXRcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICBzZWFyY2hSZXN1bHRzOiB0aGlzLmdldE9wdGlvbnNGb3JWYWx1ZSgnJywgdGhpcy5wcm9wcy5vcHRpb25zKSxcbiAgICAgICAgc2VsZWN0aW9uOiAnJyxcbiAgICAgICAgZW50cnlWYWx1ZTogJydcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnByb3BzLm9uT3B0aW9uU2VsZWN0ZWQob3B0aW9uLCBldmVudCk7XG4gIH07XG5cbiAgLy8gdXNlICgpID0+IHt9IHRvIGF2b2lkIGJpbmRpbmcgJ3RoaXMnXG4gIF9vblRleHRFbnRyeVVwZGF0ZWQgPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMucHJvcHMuc2VhcmNoYWJsZSkge1xuICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmVudHJ5LnZhbHVlO1xuXG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgc2VhcmNoUmVzdWx0czogdGhpcy5nZXRPcHRpb25zRm9yVmFsdWUodmFsdWUsIHRoaXMucHJvcHMub3B0aW9ucyksXG4gICAgICAgIHNlbGVjdGlvbjogJycsXG4gICAgICAgIGVudHJ5VmFsdWU6IHZhbHVlXG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgX29uRW50ZXIgPSBldmVudCA9PiB7XG4gICAgY29uc3Qgc2VsZWN0aW9uID0gdGhpcy5nZXRTZWxlY3Rpb24oKTtcbiAgICBpZiAoIXNlbGVjdGlvbikge1xuICAgICAgcmV0dXJuIHRoaXMucHJvcHMub25LZXlEb3duKGV2ZW50KTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX29uT3B0aW9uU2VsZWN0ZWQoc2VsZWN0aW9uLCBldmVudCk7XG4gIH07XG5cbiAgX29uRXNjYXBlKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgc2VsZWN0aW9uSW5kZXg6IG51bGxcbiAgICB9KTtcbiAgfVxuXG4gIF9vblRhYihldmVudCkge1xuICAgIGNvbnN0IHNlbGVjdGlvbiA9IHRoaXMuZ2V0U2VsZWN0aW9uKCk7XG4gICAgbGV0IG9wdGlvbiA9IHNlbGVjdGlvblxuICAgICAgPyBzZWxlY3Rpb25cbiAgICAgIDogdGhpcy5zdGF0ZS5zZWFyY2hSZXN1bHRzLmxlbmd0aCA+IDBcbiAgICAgICAgPyB0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHNbMF1cbiAgICAgICAgOiBudWxsO1xuXG4gICAgaWYgKG9wdGlvbiA9PT0gbnVsbCAmJiB0aGlzLl9oYXNDdXN0b21WYWx1ZSgpKSB7XG4gICAgICBvcHRpb24gPSB0aGlzLl9nZXRDdXN0b21WYWx1ZSgpO1xuICAgIH1cblxuICAgIGlmIChvcHRpb24gIT09IG51bGwpIHtcbiAgICAgIHJldHVybiB0aGlzLl9vbk9wdGlvblNlbGVjdGVkKG9wdGlvbiwgZXZlbnQpO1xuICAgIH1cbiAgfVxuXG4gIGV2ZW50TWFwKGV2ZW50KSB7XG4gICAgY29uc3QgZXZlbnRzID0ge307XG5cbiAgICBldmVudHNbS2V5RXZlbnQuRE9NX1ZLX1VQXSA9IHRoaXMubmF2VXA7XG4gICAgZXZlbnRzW0tleUV2ZW50LkRPTV9WS19ET1dOXSA9IHRoaXMubmF2RG93bjtcbiAgICBldmVudHNbS2V5RXZlbnQuRE9NX1ZLX1JFVFVSTl0gPSBldmVudHNbXG4gICAgICBLZXlFdmVudC5ET01fVktfRU5URVJcbiAgICBdID0gdGhpcy5fb25FbnRlcjtcbiAgICBldmVudHNbS2V5RXZlbnQuRE9NX1ZLX0VTQ0FQRV0gPSB0aGlzLl9vbkVzY2FwZTtcbiAgICBldmVudHNbS2V5RXZlbnQuRE9NX1ZLX1RBQl0gPSB0aGlzLl9vblRhYjtcblxuICAgIHJldHVybiBldmVudHM7XG4gIH1cblxuICBfbmF2KGRlbHRhKSB7XG4gICAgaWYgKCF0aGlzLl9oYXNIaW50KCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbGV0IG5ld0luZGV4ID1cbiAgICAgIHRoaXMuc3RhdGUuc2VsZWN0aW9uSW5kZXggPT09IG51bGxcbiAgICAgICAgPyBkZWx0YSA9PT0gMSA/IDAgOiBkZWx0YVxuICAgICAgICA6IHRoaXMuc3RhdGUuc2VsZWN0aW9uSW5kZXggKyBkZWx0YTtcbiAgICBsZXQgbGVuZ3RoID0gdGhpcy5wcm9wcy5tYXhWaXNpYmxlXG4gICAgICA/IHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0cy5zbGljZSgwLCB0aGlzLnByb3BzLm1heFZpc2libGUpLmxlbmd0aFxuICAgICAgOiB0aGlzLnN0YXRlLnNlYXJjaFJlc3VsdHMubGVuZ3RoO1xuICAgIGlmICh0aGlzLl9oYXNDdXN0b21WYWx1ZSgpKSB7XG4gICAgICBsZW5ndGggKz0gMTtcbiAgICB9XG5cbiAgICBpZiAobmV3SW5kZXggPCAwKSB7XG4gICAgICBuZXdJbmRleCArPSBsZW5ndGg7XG4gICAgfSBlbHNlIGlmIChuZXdJbmRleCA+PSBsZW5ndGgpIHtcbiAgICAgIG5ld0luZGV4IC09IGxlbmd0aDtcbiAgICB9XG5cbiAgICB0aGlzLnNldFN0YXRlKHtzZWxlY3Rpb25JbmRleDogbmV3SW5kZXh9KTtcbiAgfVxuXG4gIG5hdkRvd24gPSAoKSA9PiB7XG4gICAgdGhpcy5fbmF2KDEpO1xuICB9O1xuXG4gIG5hdlVwID0gKCkgPT4ge1xuICAgIHRoaXMuX25hdigtMSk7XG4gIH07XG5cbiAgX29uQ2hhbmdlID0gZXZlbnQgPT4ge1xuICAgIGlmICh0aGlzLnByb3BzLm9uQ2hhbmdlKSB7XG4gICAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKGV2ZW50KTtcbiAgICB9XG5cbiAgICB0aGlzLl9vblRleHRFbnRyeVVwZGF0ZWQoKTtcbiAgfTtcblxuICBfb25LZXlEb3duID0gZXZlbnQgPT4ge1xuICAgIC8vIElmIHRoZXJlIGFyZSBubyB2aXNpYmxlIGVsZW1lbnRzLCBkb24ndCBwZXJmb3JtIHNlbGVjdG9yIG5hdmlnYXRpb24uXG4gICAgLy8gSnVzdCBwYXNzIHRoaXMgdXAgdG8gdGhlIHVwc3RyZWFtIG9uS2V5ZG93biBoYW5kbGVyLlxuICAgIC8vIEFsc28gc2tpcCBpZiB0aGUgdXNlciBpcyBwcmVzc2luZyB0aGUgc2hpZnQga2V5LCBzaW5jZSBub25lIG9mIG91ciBoYW5kbGVycyBhcmUgbG9va2luZyBmb3Igc2hpZnRcbiAgICBpZiAoIXRoaXMuX2hhc0hpbnQoKSB8fCBldmVudC5zaGlmdEtleSkge1xuICAgICAgcmV0dXJuIHRoaXMucHJvcHMub25LZXlEb3duKGV2ZW50KTtcbiAgICB9XG5cbiAgICBjb25zdCBoYW5kbGVyID0gdGhpcy5ldmVudE1hcCgpW2V2ZW50LmtleUNvZGVdO1xuXG4gICAgaWYgKGhhbmRsZXIpIHtcbiAgICAgIGhhbmRsZXIoZXZlbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5wcm9wcy5vbktleURvd24oZXZlbnQpO1xuICAgIH1cbiAgICAvLyBEb24ndCBwcm9wYWdhdGUgdGhlIGtleXN0cm9rZSBiYWNrIHRvIHRoZSBET00vYnJvd3NlclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIH07XG5cbiAgX29uRm9jdXMgPSBldmVudCA9PiB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7aXNGb2N1c2VkOiB0cnVlfSk7XG4gICAgaWYgKHRoaXMucHJvcHMub25Gb2N1cykge1xuICAgICAgcmV0dXJuIHRoaXMucHJvcHMub25Gb2N1cyhldmVudCk7XG4gICAgfVxuICB9O1xuXG4gIF9vbkJsdXIgPSBldmVudCA9PiB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7aXNGb2N1c2VkOiBmYWxzZX0pO1xuICAgIGlmICh0aGlzLnByb3BzLm9uQmx1cikge1xuICAgICAgcmV0dXJuIHRoaXMucHJvcHMub25CbHVyKGV2ZW50KTtcbiAgICB9XG4gIH07XG5cbiAgX3JlbmRlckhpZGRlbklucHV0KCkge1xuICAgIGlmICghdGhpcy5wcm9wcy5uYW1lKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgPGlucHV0XG4gICAgICAgIHR5cGU9XCJoaWRkZW5cIlxuICAgICAgICBuYW1lPXt0aGlzLnByb3BzLm5hbWV9XG4gICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLnNlbGVjdGlvbn1cbiAgICAgIC8+XG4gICAgKTtcbiAgfVxuXG4gIF9nZW5lcmF0ZVNlYXJjaEZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IHNlYXJjaE9wdGlvbnNQcm9wID0gdGhpcy5wcm9wcy5zZWFyY2hPcHRpb25zO1xuICAgIGNvbnN0IGZpbHRlck9wdGlvblByb3AgPSB0aGlzLnByb3BzLmZpbHRlck9wdGlvbjtcbiAgICBpZiAodHlwZW9mIHNlYXJjaE9wdGlvbnNQcm9wID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBpZiAoZmlsdGVyT3B0aW9uUHJvcCAhPT0gbnVsbCkge1xuICAgICAgICBDb25zb2xlLndhcm4oXG4gICAgICAgICAgJ3NlYXJjaE9wdGlvbnMgcHJvcCBpcyBiZWluZyB1c2VkLCBmaWx0ZXJPcHRpb24gcHJvcCB3aWxsIGJlIGlnbm9yZWQnXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gc2VhcmNoT3B0aW9uc1Byb3A7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgZmlsdGVyT3B0aW9uUHJvcCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgLy8gdXNlIGN1c3RvbSBmaWx0ZXIgb3B0aW9uXG4gICAgICByZXR1cm4gKHZhbHVlLCBvcHRpb25zKSA9PlxuICAgICAgICBvcHRpb25zLmZpbHRlcihvID0+IGZpbHRlck9wdGlvblByb3AodmFsdWUsIG8pKTtcbiAgICB9XG5cbiAgICBjb25zdCBtYXBwZXIgPVxuICAgICAgdHlwZW9mIGZpbHRlck9wdGlvblByb3AgPT09ICdzdHJpbmcnXG4gICAgICAgID8gQWNjZXNzb3IuZ2VuZXJhdGVBY2Nlc3NvcihmaWx0ZXJPcHRpb25Qcm9wKVxuICAgICAgICA6IEFjY2Vzc29yLklERU5USVRZX0ZOO1xuXG4gICAgcmV0dXJuICh2YWx1ZSwgb3B0aW9ucykgPT5cbiAgICAgIGZ1enp5XG4gICAgICAgIC5maWx0ZXIodmFsdWUsIG9wdGlvbnMsIHtleHRyYWN0OiBtYXBwZXJ9KVxuICAgICAgICAubWFwKHJlcyA9PiBvcHRpb25zW3Jlcy5pbmRleF0pO1xuICB9XG5cbiAgX2hhc0hpbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdGUuc2VhcmNoUmVzdWx0cy5sZW5ndGggPiAwIHx8IHRoaXMuX2hhc0N1c3RvbVZhbHVlKCk7XG4gIH1cblxuICBfaGFzRml4ZWRPcHRpb25zKCkge1xuICAgIHJldHVybiAoXG4gICAgICBBcnJheS5pc0FycmF5KHRoaXMucHJvcHMuZml4ZWRPcHRpb25zKSAmJiB0aGlzLnByb3BzLmZpeGVkT3B0aW9ucy5sZW5ndGhcbiAgICApO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IGlucHV0Q2xhc3NlcyA9IHt9O1xuICAgIGlucHV0Q2xhc3Nlc1t0aGlzLnByb3BzLmN1c3RvbUNsYXNzZXMuaW5wdXRdID0gQm9vbGVhbihcbiAgICAgIHRoaXMucHJvcHMuY3VzdG9tQ2xhc3Nlcy5pbnB1dFxuICAgICk7XG4gICAgY29uc3QgaW5wdXRDbGFzc0xpc3QgPSBjbGFzc05hbWVzKGlucHV0Q2xhc3Nlcyk7XG5cbiAgICBjb25zdCBjbGFzc2VzID0ge1xuICAgICAgW0RFRkFVTFRfQ0xBU1NdOiB0aGlzLnByb3BzLmRlZmF1bHRDbGFzc05hbWVzXG4gICAgfTtcbiAgICBjbGFzc2VzW3RoaXMucHJvcHMuY2xhc3NOYW1lXSA9IEJvb2xlYW4odGhpcy5wcm9wcy5jbGFzc05hbWUpO1xuICAgIGNvbnN0IGNsYXNzTGlzdCA9IGNsYXNzTmFtZXMoY2xhc3Nlcyk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFR5cGVhaGVhZFdyYXBwZXJcbiAgICAgICAgY2xhc3NOYW1lPXtjbGFzc0xpc3R9XG4gICAgICAgIGlubmVyUmVmPXtjb21wID0+IHtcbiAgICAgICAgICB0aGlzLnJvb3QgPSBjb21wO1xuICAgICAgICB9fVxuICAgICAgICB0YWJJbmRleD1cIjBcIlxuICAgICAgICBvbktleURvd249e3RoaXMuX29uS2V5RG93bn1cbiAgICAgICAgb25LZXlQcmVzcz17dGhpcy5wcm9wcy5vbktleVByZXNzfVxuICAgICAgICBvbktleVVwPXt0aGlzLnByb3BzLm9uS2V5VXB9XG4gICAgICAgIG9uRm9jdXM9e3RoaXMuX29uRm9jdXN9XG4gICAgICA+XG4gICAgICAgIHt0aGlzLl9yZW5kZXJIaWRkZW5JbnB1dCgpfVxuICAgICAgICB7dGhpcy5wcm9wcy5zZWFyY2hhYmxlID8gKFxuICAgICAgICA8SW5wdXRCb3g+XG4gICAgICAgICAgPFR5cGVhaGVhZElucHV0XG4gICAgICAgICAgICBpbm5lclJlZj17Y29tcCA9PiB7XG4gICAgICAgICAgICAgIHRoaXMuZW50cnkgPSBjb21wO1xuICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgIGRpc2FibGVkPXt0aGlzLnByb3BzLmRpc2FibGVkfVxuICAgICAgICAgICAgey4uLnRoaXMucHJvcHMuaW5wdXRQcm9wc31cbiAgICAgICAgICAgIHBsYWNlaG9sZGVyPXt0aGlzLnByb3BzLnBsYWNlaG9sZGVyfVxuICAgICAgICAgICAgY2xhc3NOYW1lPXtpbnB1dENsYXNzTGlzdH1cbiAgICAgICAgICAgIHZhbHVlPXt0aGlzLnN0YXRlLmVudHJ5VmFsdWV9XG4gICAgICAgICAgICBvbkNoYW5nZT17dGhpcy5fb25DaGFuZ2V9XG4gICAgICAgICAgICBvbkJsdXI9e3RoaXMuX29uQmx1cn1cbiAgICAgICAgICAvPlxuICAgICAgICAgIDxJbnB1dEljb24+XG4gICAgICAgICAgICA8U2VhcmNoIGhlaWdodD1cIjE4cHhcIi8+XG4gICAgICAgICAgPC9JbnB1dEljb24+XG4gICAgICAgIDwvSW5wdXRCb3g+XG4gICAgICAgICkgOiBudWxsfVxuICAgICAgICB7dGhpcy5fcmVuZGVySW5jcmVtZW50YWxTZWFyY2hSZXN1bHRzKCl9XG4gICAgICA8L1R5cGVhaGVhZFdyYXBwZXI+XG4gICAgKTtcbiAgfVxufTtcbiJdfQ==
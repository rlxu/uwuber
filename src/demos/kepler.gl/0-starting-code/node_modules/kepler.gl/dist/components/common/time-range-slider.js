'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = undefined;

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _taggedTemplateLiteral2 = require('babel-runtime/helpers/taggedTemplateLiteral');

var _taggedTemplateLiteral3 = _interopRequireDefault(_taggedTemplateLiteral2);

var _class, _temp, _initialiseProps;

var _templateObject = (0, _taggedTemplateLiteral3.default)(['\n  margin-top: ', ';\n  align-items: flex-end;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n'], ['\n  margin-top: ', ';\n  align-items: flex-end;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n']),
    _templateObject2 = (0, _taggedTemplateLiteral3.default)(['\n  display: flex;\n  height: ', ';\n  align-items: center;\n  font-size: 11px;\n  justify-content: ', ';\n  color: ', ';\n\n  .horizontal-bar {\n    padding: 0 12px;\n  }\n\n  .time-value {\n    display: flex;\n    flex-direction: ', ';\n    align-items: flex-start;\n  }\n\n  .time-value:last-child {\n    align-items: flex-end;\n  }\n'], ['\n  display: flex;\n  height: ', ';\n  align-items: center;\n  font-size: 11px;\n  justify-content: ', ';\n  color: ', ';\n\n  .horizontal-bar {\n    padding: 0 12px;\n  }\n\n  .time-value {\n    display: flex;\n    flex-direction: ', ';\n    align-items: flex-start;\n  }\n\n  .time-value:last-child {\n    align-items: flex-end;\n  }\n']),
    _templateObject3 = (0, _taggedTemplateLiteral3.default)(['\n  margin-bottom: 12px;\n  margin-right: 42px;\n\n  &.disabled {\n    opacity: 0.4;\n    pointer-events: none;\n  }\n'], ['\n  margin-bottom: 12px;\n  margin-right: 42px;\n\n  &.disabled {\n    opacity: 0.4;\n    pointer-events: none;\n  }\n']),
    _templateObject4 = (0, _taggedTemplateLiteral3.default)(['\n  svg {\n    margin: 0 6px;\n  }\n'], ['\n  svg {\n    margin: 0 6px;\n  }\n']); // Copyright (c) 2018 Uber Technologies, Inc.
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the "Software"), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
//
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _propTypes = require('prop-types');

var _propTypes2 = _interopRequireDefault(_propTypes);

var _moment = require('moment');

var _moment2 = _interopRequireDefault(_moment);

var _window = require('global/window');

var _classnames = require('classnames');

var _classnames2 = _interopRequireDefault(_classnames);

var _lodash = require('lodash.throttle');

var _lodash2 = _interopRequireDefault(_lodash);

var _styledComponents = require('styled-components');

var _styledComponents2 = _interopRequireDefault(_styledComponents);

var _reselect = require('reselect');

var _icons = require('./icons');

var _styledComponents3 = require('./styled-components');

var _filterUtils = require('../../utils/filter-utils');

var _rangeSlider = require('./range-slider');

var _rangeSlider2 = _interopRequireDefault(_rangeSlider);

var _timeSliderMarker = require('./time-slider-marker');

var _timeSliderMarker2 = _interopRequireDefault(_timeSliderMarker);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var defaultTimeFormat = function defaultTimeFormat(val) {
  return _moment2.default.utc(val).format('MM/DD/YY hh:mma');
};
var animationControlWidth = 140;

var StyledSliderContainer = _styledComponents2.default.div(_templateObject, function (props) {
  return props.isEnlarged ? '12px' : '0px';
});

var TimeRangeSlider = (_temp = _class = function (_Component) {
  (0, _inherits3.default)(TimeRangeSlider, _Component);

  function TimeRangeSlider(props) {
    (0, _classCallCheck3.default)(this, TimeRangeSlider);

    var _this = (0, _possibleConstructorReturn3.default)(this, (TimeRangeSlider.__proto__ || Object.getPrototypeOf(TimeRangeSlider)).call(this, props));

    _initialiseProps.call(_this);

    _this.state = {
      isAnimating: false,
      width: 288
    };
    _this._animation = null;
    _this._sliderThrottle = (0, _lodash2.default)(_this.props.onChange, 20);
    return _this;
  }

  (0, _createClass3.default)(TimeRangeSlider, [{
    key: 'componentDidUpdate',
    value: function componentDidUpdate() {
      if (!this._animation && this.state.isAnimating) {
        this._animation = (0, _window.requestAnimationFrame)(this._nextFrame);
      }
    }
  }, {
    key: 'render',
    value: function render() {
      var _props = this.props,
          domain = _props.domain,
          value = _props.value,
          isEnlarged = _props.isEnlarged;
      var isAnimating = this.state.isAnimating;


      return _react2.default.createElement(
        'div',
        { className: 'time-range-slider' },
        _react2.default.createElement(TimeTitle, {
          timeFormat: this.titleFormatter(this.props),
          value: value,
          isEnlarged: isEnlarged
        }),
        _react2.default.createElement(
          StyledSliderContainer,
          {
            className: 'time-range-slider__container',
            isEnlarged: isEnlarged },
          isEnlarged ? _react2.default.createElement(AnimationControls, {
            isAnimatable: this.props.isAnimatable,
            isEnlarged: isEnlarged,
            isAnimating: isAnimating,
            pauseAnimation: this._pauseAnimation,
            resetAnimation: this._resetAnimation,
            startAnimation: this._startAnimation
          }) : null,
          _react2.default.createElement(
            'div',
            { style: { width: isEnlarged ? 'calc(100% - ' + animationControlWidth + 'px)' : '100%' } },
            _react2.default.createElement(_rangeSlider2.default, {
              range: domain,
              value0: value[0],
              value1: value[1],
              histogram: this.props.histogram,
              lineChart: this.props.lineChart,
              plotType: this.props.plotType,
              isEnlarged: isEnlarged,
              showInput: false,
              step: this.props.step,
              onChange: this._sliderUpdate,
              xAxis: _timeSliderMarker2.default
            })
          )
        )
      );
    }
  }]);
  return TimeRangeSlider;
}(_react.Component), _class.propTypes = {
  onChange: _propTypes2.default.func.isRequired,
  domain: _propTypes2.default.arrayOf(_propTypes2.default.number).isRequired,
  value: _propTypes2.default.arrayOf(_propTypes2.default.number).isRequired,
  step: _propTypes2.default.number.isRequired,
  plotType: _propTypes2.default.string,
  histogram: _propTypes2.default.arrayOf(_propTypes2.default.any),
  lineChart: _propTypes2.default.object,
  toggleAnimation: _propTypes2.default.func.isRequired,
  isAnimatable: _propTypes2.default.bool,
  isEnlarged: _propTypes2.default.bool,
  speed: _propTypes2.default.number
}, _initialiseProps = function _initialiseProps() {
  var _this2 = this;

  this.domainSelector = function (props) {
    return props.domain;
  };

  this.titleFormatter = (0, _reselect.createSelector)(this.domainSelector, function (domain) {
    return (0, _filterUtils.getTimeWidgetTitleFormatter)(domain);
  });

  this._sliderUpdate = function (args) {
    _this2._sliderThrottle.cancel();
    _this2._sliderThrottle(args);
  };

  this._resetAnimation = function () {
    var _props2 = _this2.props,
        domain = _props2.domain,
        value = _props2.value;

    var value0 = domain[0];
    var value1 = value0 + value[1] - value[0];
    _this2.props.onChange([value0, value1]);
  };

  this._startAnimation = function () {
    _this2._pauseAnimation();
    _this2.props.toggleAnimation();
    _this2.setState({ isAnimating: true });
  };

  this._pauseAnimation = function () {
    if (_this2._animation) {
      (0, _window.cancelAnimationFrame)(_this2._animation);
      _this2.props.toggleAnimation();
      _this2._animation = null;
    }
    _this2.setState({ isAnimating: false });
  };

  this._nextFrame = function () {
    _this2._animation = null;

    var _props3 = _this2.props,
        domain = _props3.domain,
        value = _props3.value;

    var speed = (domain[1] - domain[0]) / _filterUtils.BASE_SPEED * _this2.props.speed;

    // loop when reaches the end
    var value0 = value[1] + speed > domain[1] ? domain[0] : value[0] + speed;
    var value1 = value0 + value[1] - value[0];
    _this2.props.onChange([value0, value1]);
  };
}, _temp);
exports.default = TimeRangeSlider;


var TimeValueWrapper = _styledComponents2.default.div(_templateObject2, function (props) {
  return props.theme.secondaryInputHeight;
}, function (props) {
  return props.isEnlarged ? 'center' : 'space-between';
}, function (props) {
  return props.theme.labelColor;
}, function (props) {
  return props.isEnlarged ? 'row' : 'column';
});

var TimeTitle = function TimeTitle(_ref) {
  var value = _ref.value,
      isEnlarged = _ref.isEnlarged,
      _ref$timeFormat = _ref.timeFormat,
      timeFormat = _ref$timeFormat === undefined ? defaultTimeFormat : _ref$timeFormat;
  return _react2.default.createElement(
    TimeValueWrapper,
    { isEnlarged: isEnlarged },
    _react2.default.createElement(TimeValue, { key: 0, value: _moment2.default.utc(value[0]).format(timeFormat), split: !isEnlarged }),
    isEnlarged ? _react2.default.createElement(
      'div',
      { className: 'horizontal-bar' },
      _react2.default.createElement(_icons.Minus, { height: '12px' })
    ) : null,
    _react2.default.createElement(TimeValue, { key: 1, value: _moment2.default.utc(value[1]).format(timeFormat), split: !isEnlarged })
  );
};

var TimeValue = function TimeValue(_ref2) {
  var value = _ref2.value,
      split = _ref2.split;
  return (
    // render two lines if not enlarged
    _react2.default.createElement(
      'div',
      { className: 'time-value' },
      split ? value.split(' ').map(function (v, i) {
        return _react2.default.createElement(
          'div',
          { key: i },
          i === 0 ? _react2.default.createElement(
            _styledComponents3.SelectText,
            null,
            v
          ) : _react2.default.createElement(
            _styledComponents3.SelectTextBold,
            null,
            v
          )
        );
      }) : _react2.default.createElement(
        _styledComponents3.SelectTextBold,
        null,
        value
      )
    )
  );
};

var StyledAnimationControls = _styledComponents2.default.div(_templateObject3);

var IconButton = _styledComponents3.Button.extend(_templateObject4);

var AnimationControls = function AnimationControls(_ref3) {
  var isAnimatable = _ref3.isAnimatable,
      isAnimating = _ref3.isAnimating,
      pauseAnimation = _ref3.pauseAnimation,
      resetAnimation = _ref3.resetAnimation,
      startAnimation = _ref3.startAnimation;
  return _react2.default.createElement(
    StyledAnimationControls,
    {
      className: (0, _classnames2.default)('time-range-slider__control', { disabled: !isAnimatable })
    },
    _react2.default.createElement(
      _styledComponents3.ButtonGroup,
      null,
      _react2.default.createElement(
        IconButton,
        { className: 'playback-control-button',
          onClick: resetAnimation, secondary: true },
        _react2.default.createElement(_icons.Reset, { height: '12px' })
      ),
      _react2.default.createElement(
        IconButton,
        { className: (0, _classnames2.default)('playback-control-button', { active: isAnimating }),
          onClick: isAnimating ? pauseAnimation : startAnimation, secondary: true },
        isAnimating ? _react2.default.createElement(_icons.Pause, { height: '12px' }) : _react2.default.createElement(_icons.Play, { height: '12px' })
      )
    )
  );
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL2NvbW1vbi90aW1lLXJhbmdlLXNsaWRlci5qcyJdLCJuYW1lcyI6WyJkZWZhdWx0VGltZUZvcm1hdCIsIm1vbWVudCIsInV0YyIsInZhbCIsImZvcm1hdCIsImFuaW1hdGlvbkNvbnRyb2xXaWR0aCIsIlN0eWxlZFNsaWRlckNvbnRhaW5lciIsInN0eWxlZCIsImRpdiIsInByb3BzIiwiaXNFbmxhcmdlZCIsIlRpbWVSYW5nZVNsaWRlciIsInN0YXRlIiwiaXNBbmltYXRpbmciLCJ3aWR0aCIsIl9hbmltYXRpb24iLCJfc2xpZGVyVGhyb3R0bGUiLCJvbkNoYW5nZSIsIl9uZXh0RnJhbWUiLCJkb21haW4iLCJ2YWx1ZSIsInRpdGxlRm9ybWF0dGVyIiwiaXNBbmltYXRhYmxlIiwiX3BhdXNlQW5pbWF0aW9uIiwiX3Jlc2V0QW5pbWF0aW9uIiwiX3N0YXJ0QW5pbWF0aW9uIiwiaGlzdG9ncmFtIiwibGluZUNoYXJ0IiwicGxvdFR5cGUiLCJzdGVwIiwiX3NsaWRlclVwZGF0ZSIsIlRpbWVTbGlkZXJNYXJrZXIiLCJDb21wb25lbnQiLCJwcm9wVHlwZXMiLCJQcm9wVHlwZXMiLCJmdW5jIiwiaXNSZXF1aXJlZCIsImFycmF5T2YiLCJudW1iZXIiLCJzdHJpbmciLCJhbnkiLCJvYmplY3QiLCJ0b2dnbGVBbmltYXRpb24iLCJib29sIiwic3BlZWQiLCJkb21haW5TZWxlY3RvciIsImNhbmNlbCIsImFyZ3MiLCJ2YWx1ZTAiLCJ2YWx1ZTEiLCJzZXRTdGF0ZSIsIkJBU0VfU1BFRUQiLCJUaW1lVmFsdWVXcmFwcGVyIiwidGhlbWUiLCJzZWNvbmRhcnlJbnB1dEhlaWdodCIsImxhYmVsQ29sb3IiLCJUaW1lVGl0bGUiLCJ0aW1lRm9ybWF0IiwiVGltZVZhbHVlIiwic3BsaXQiLCJtYXAiLCJ2IiwiaSIsIlN0eWxlZEFuaW1hdGlvbkNvbnRyb2xzIiwiSWNvbkJ1dHRvbiIsIkJ1dHRvbiIsImV4dGVuZCIsIkFuaW1hdGlvbkNvbnRyb2xzIiwicGF1c2VBbmltYXRpb24iLCJyZXNldEFuaW1hdGlvbiIsInN0YXJ0QW5pbWF0aW9uIiwiZGlzYWJsZWQiLCJhY3RpdmUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O2lKQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBQ0E7Ozs7OztBQUVBLElBQU1BLG9CQUFvQixTQUFwQkEsaUJBQW9CO0FBQUEsU0FBT0MsaUJBQU9DLEdBQVAsQ0FBV0MsR0FBWCxFQUFnQkMsTUFBaEIsQ0FBdUIsaUJBQXZCLENBQVA7QUFBQSxDQUExQjtBQUNBLElBQU1DLHdCQUF3QixHQUE5Qjs7QUFFQSxJQUFNQyx3QkFBd0JDLDJCQUFPQyxHQUEvQixrQkFDVTtBQUFBLFNBQVNDLE1BQU1DLFVBQU4sR0FBbUIsTUFBbkIsR0FBNEIsS0FBckM7QUFBQSxDQURWLENBQU47O0lBUXFCQyxlOzs7QUFlbkIsMkJBQVlGLEtBQVosRUFBbUI7QUFBQTs7QUFBQSxnSkFDWEEsS0FEVzs7QUFBQTs7QUFFakIsVUFBS0csS0FBTCxHQUFhO0FBQ1hDLG1CQUFhLEtBREY7QUFFWEMsYUFBTztBQUZJLEtBQWI7QUFJQSxVQUFLQyxVQUFMLEdBQWtCLElBQWxCO0FBQ0EsVUFBS0MsZUFBTCxHQUF1QixzQkFBUyxNQUFLUCxLQUFMLENBQVdRLFFBQXBCLEVBQThCLEVBQTlCLENBQXZCO0FBUGlCO0FBUWxCOzs7O3lDQUVvQjtBQUNuQixVQUFJLENBQUMsS0FBS0YsVUFBTixJQUFvQixLQUFLSCxLQUFMLENBQVdDLFdBQW5DLEVBQWdEO0FBQzlDLGFBQUtFLFVBQUwsR0FBa0IsbUNBQXNCLEtBQUtHLFVBQTNC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QSxjQUFjdUQsY0FBZCxHQUErQkUsY0FEMUMsRUFDMEQsZUFEMUQ7QUFFR3pELHNCQUFjLDhCQUFDLFlBQUQsSUFBTyxRQUFPLE1BQWQsR0FBZCxHQUF1Qyw4QkFBQyxXQUFELElBQU0sUUFBTyxNQUFiO0FBRjFDO0FBTEY7QUFIRixHQVB3QjtBQUFBLENBQTFCIiwiZmlsZSI6InRpbWUtcmFuZ2Utc2xpZGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSAyMDE4IFViZXIgVGVjaG5vbG9naWVzLCBJbmMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4vLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4vLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4vLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbi8vIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbi8vIFRIRSBTT0ZUV0FSRS5cblxuaW1wb3J0IFJlYWN0LCB7Q29tcG9uZW50fSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IHtyZXF1ZXN0QW5pbWF0aW9uRnJhbWUsIGNhbmNlbEFuaW1hdGlvbkZyYW1lfSBmcm9tICdnbG9iYWwvd2luZG93JztcbmltcG9ydCBjbGFzc25hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IHRocm90dGxlIGZyb20gJ2xvZGFzaC50aHJvdHRsZSc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ3N0eWxlZC1jb21wb25lbnRzJztcbmltcG9ydCB7Y3JlYXRlU2VsZWN0b3J9IGZyb20gJ3Jlc2VsZWN0JztcbmltcG9ydCB7UGxheSwgUmVzZXQsIFBhdXNlLCBNaW51c30gZnJvbSAnY29tcG9uZW50cy9jb21tb24vaWNvbnMnO1xuaW1wb3J0IHtTZWxlY3RUZXh0Qm9sZCwgU2VsZWN0VGV4dCwgQnV0dG9uLCBCdXR0b25Hcm91cH0gZnJvbSAnY29tcG9uZW50cy9jb21tb24vc3R5bGVkLWNvbXBvbmVudHMnO1xuaW1wb3J0IHtnZXRUaW1lV2lkZ2V0VGl0bGVGb3JtYXR0ZXIsIEJBU0VfU1BFRUR9IGZyb20gJ3V0aWxzL2ZpbHRlci11dGlscyc7XG5pbXBvcnQgUmFuZ2VTbGlkZXIgZnJvbSAnLi9yYW5nZS1zbGlkZXInO1xuaW1wb3J0IFRpbWVTbGlkZXJNYXJrZXIgZnJvbSAnLi90aW1lLXNsaWRlci1tYXJrZXInO1xuXG5jb25zdCBkZWZhdWx0VGltZUZvcm1hdCA9IHZhbCA9PiBtb21lbnQudXRjKHZhbCkuZm9ybWF0KCdNTS9ERC9ZWSBoaDptbWEnKTtcbmNvbnN0IGFuaW1hdGlvbkNvbnRyb2xXaWR0aCA9IDE0MDtcblxuY29uc3QgU3R5bGVkU2xpZGVyQ29udGFpbmVyID0gc3R5bGVkLmRpdmBcbiAgbWFyZ2luLXRvcDogJHtwcm9wcyA9PiBwcm9wcy5pc0VubGFyZ2VkID8gJzEycHgnIDogJzBweCd9O1xuICBhbGlnbi1pdGVtczogZmxleC1lbmQ7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiByb3c7XG4gIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbmA7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRpbWVSYW5nZVNsaWRlciBleHRlbmRzIENvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgb25DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgZG9tYWluOiBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMubnVtYmVyKS5pc1JlcXVpcmVkLFxuICAgIHZhbHVlOiBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMubnVtYmVyKS5pc1JlcXVpcmVkLFxuICAgIHN0ZXA6IFByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcbiAgICBwbG90VHlwZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBoaXN0b2dyYW06IFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5hbnkpLFxuICAgIGxpbmVDaGFydDogUHJvcFR5cGVzLm9iamVjdCxcbiAgICB0b2dnbGVBbmltYXRpb246IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgaXNBbmltYXRhYmxlOiBQcm9wVHlwZXMuYm9vbCxcbiAgICBpc0VubGFyZ2VkOiBQcm9wVHlwZXMuYm9vbCxcbiAgICBzcGVlZDogUHJvcFR5cGVzLm51bWJlclxuICB9O1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBpc0FuaW1hdGluZzogZmFsc2UsXG4gICAgICB3aWR0aDogMjg4XG4gICAgfTtcbiAgICB0aGlzLl9hbmltYXRpb24gPSBudWxsO1xuICAgIHRoaXMuX3NsaWRlclRocm90dGxlID0gdGhyb3R0bGUodGhpcy5wcm9wcy5vbkNoYW5nZSwgMjApO1xuICB9XG5cbiAgY29tcG9uZW50RGlkVXBkYXRlKCkge1xuICAgIGlmICghdGhpcy5fYW5pbWF0aW9uICYmIHRoaXMuc3RhdGUuaXNBbmltYXRpbmcpIHtcbiAgICAgIHRoaXMuX2FuaW1hdGlvbiA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLl9uZXh0RnJhbWUpO1xuICAgIH1cbiAgfVxuXG4gIGRvbWFpblNlbGVjdG9yID0gcHJvcHMgPT4gcHJvcHMuZG9tYWluO1xuICB0aXRsZUZvcm1hdHRlciA9IGNyZWF0ZVNlbGVjdG9yKHRoaXMuZG9tYWluU2VsZWN0b3IsIGRvbWFpbiA9PlxuICAgIGdldFRpbWVXaWRnZXRUaXRsZUZvcm1hdHRlcihkb21haW4pXG4gICk7XG5cbiAgX3NsaWRlclVwZGF0ZSA9IGFyZ3MgPT4ge1xuICAgIHRoaXMuX3NsaWRlclRocm90dGxlLmNhbmNlbCgpO1xuICAgIHRoaXMuX3NsaWRlclRocm90dGxlKGFyZ3MpO1xuICB9O1xuXG4gIF9yZXNldEFuaW1hdGlvbiA9ICgpID0+IHtcbiAgICBjb25zdCB7ZG9tYWluLCB2YWx1ZX0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHZhbHVlMCA9IGRvbWFpblswXTtcbiAgICBjb25zdCB2YWx1ZTEgPSB2YWx1ZTAgKyB2YWx1ZVsxXSAtIHZhbHVlWzBdO1xuICAgIHRoaXMucHJvcHMub25DaGFuZ2UoW3ZhbHVlMCwgdmFsdWUxXSk7XG4gIH07XG5cbiAgX3N0YXJ0QW5pbWF0aW9uID0gKCkgPT4ge1xuICAgIHRoaXMuX3BhdXNlQW5pbWF0aW9uKCk7XG4gICAgdGhpcy5wcm9wcy50b2dnbGVBbmltYXRpb24oKTtcbiAgICB0aGlzLnNldFN0YXRlKHtpc0FuaW1hdGluZzogdHJ1ZX0pO1xuICB9O1xuXG4gIF9wYXVzZUFuaW1hdGlvbiA9ICgpID0+IHtcbiAgICBpZiAodGhpcy5fYW5pbWF0aW9uKSB7XG4gICAgICBjYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLl9hbmltYXRpb24pO1xuICAgICAgdGhpcy5wcm9wcy50b2dnbGVBbmltYXRpb24oKTtcbiAgICAgIHRoaXMuX2FuaW1hdGlvbiA9IG51bGw7XG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUoe2lzQW5pbWF0aW5nOiBmYWxzZX0pO1xuICB9O1xuXG4gIF9uZXh0RnJhbWUgPSAoKSA9PiB7XG4gICAgdGhpcy5fYW5pbWF0aW9uID0gbnVsbDtcblxuICAgIGNvbnN0IHtkb21haW4sIHZhbHVlfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3Qgc3BlZWQgPSAoKGRvbWFpblsxXSAtIGRvbWFpblswXSkgLyBCQVNFX1NQRUVEKSAqIHRoaXMucHJvcHMuc3BlZWQ7XG5cbiAgICAvLyBsb29wIHdoZW4gcmVhY2hlcyB0aGUgZW5kXG4gICAgY29uc3QgdmFsdWUwID0gdmFsdWVbMV0gKyBzcGVlZCA+IGRvbWFpblsxXSA/IGRvbWFpblswXSA6IHZhbHVlWzBdICsgc3BlZWQ7XG4gICAgY29uc3QgdmFsdWUxID0gdmFsdWUwICsgdmFsdWVbMV0gLSB2YWx1ZVswXTtcbiAgICB0aGlzLnByb3BzLm9uQ2hhbmdlKFt2YWx1ZTAsIHZhbHVlMV0pO1xuICB9O1xuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7ZG9tYWluLCB2YWx1ZSwgaXNFbmxhcmdlZH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHtpc0FuaW1hdGluZ30gPSB0aGlzLnN0YXRlO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGltZS1yYW5nZS1zbGlkZXJcIj5cbiAgICAgICAgPFRpbWVUaXRsZVxuICAgICAgICAgIHRpbWVGb3JtYXQ9e3RoaXMudGl0bGVGb3JtYXR0ZXIodGhpcy5wcm9wcyl9XG4gICAgICAgICAgdmFsdWU9e3ZhbHVlfVxuICAgICAgICAgIGlzRW5sYXJnZWQ9e2lzRW5sYXJnZWR9XG4gICAgICAgIC8+XG4gICAgICAgIDxTdHlsZWRTbGlkZXJDb250YWluZXJcbiAgICAgICAgICBjbGFzc05hbWU9XCJ0aW1lLXJhbmdlLXNsaWRlcl9fY29udGFpbmVyXCJcbiAgICAgICAgICBpc0VubGFyZ2VkPXtpc0VubGFyZ2VkfT5cbiAgICAgICAgICB7aXNFbmxhcmdlZCA/IDxBbmltYXRpb25Db250cm9sc1xuICAgICAgICAgICAgaXNBbmltYXRhYmxlPXt0aGlzLnByb3BzLmlzQW5pbWF0YWJsZX1cbiAgICAgICAgICAgIGlzRW5sYXJnZWQ9e2lzRW5sYXJnZWR9XG4gICAgICAgICAgICBpc0FuaW1hdGluZz17aXNBbmltYXRpbmd9XG4gICAgICAgICAgICBwYXVzZUFuaW1hdGlvbj17dGhpcy5fcGF1c2VBbmltYXRpb259XG4gICAgICAgICAgICByZXNldEFuaW1hdGlvbj17dGhpcy5fcmVzZXRBbmltYXRpb259XG4gICAgICAgICAgICBzdGFydEFuaW1hdGlvbj17dGhpcy5fc3RhcnRBbmltYXRpb259XG4gICAgICAgICAgLz4gOiBudWxsfVxuICAgICAgICAgIDxkaXYgc3R5bGU9e3t3aWR0aDogaXNFbmxhcmdlZCA/IGBjYWxjKDEwMCUgLSAke2FuaW1hdGlvbkNvbnRyb2xXaWR0aH1weClgIDogJzEwMCUnfX0+XG4gICAgICAgICAgICA8UmFuZ2VTbGlkZXJcbiAgICAgICAgICAgICAgcmFuZ2U9e2RvbWFpbn1cbiAgICAgICAgICAgICAgdmFsdWUwPXt2YWx1ZVswXX1cbiAgICAgICAgICAgICAgdmFsdWUxPXt2YWx1ZVsxXX1cbiAgICAgICAgICAgICAgaGlzdG9ncmFtPXt0aGlzLnByb3BzLmhpc3RvZ3JhbX1cbiAgICAgICAgICAgICAgbGluZUNoYXJ0PXt0aGlzLnByb3BzLmxpbmVDaGFydH1cbiAgICAgICAgICAgICAgcGxvdFR5cGU9e3RoaXMucHJvcHMucGxvdFR5cGV9XG4gICAgICAgICAgICAgIGlzRW5sYXJnZWQ9e2lzRW5sYXJnZWR9XG4gICAgICAgICAgICAgIHNob3dJbnB1dD17ZmFsc2V9XG4gICAgICAgICAgICAgIHN0ZXA9e3RoaXMucHJvcHMuc3RlcH1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9e3RoaXMuX3NsaWRlclVwZGF0ZX1cbiAgICAgICAgICAgICAgeEF4aXM9e1RpbWVTbGlkZXJNYXJrZXJ9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L1N0eWxlZFNsaWRlckNvbnRhaW5lcj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cbn1cblxuY29uc3QgVGltZVZhbHVlV3JhcHBlciA9IHN0eWxlZC5kaXZgXG4gIGRpc3BsYXk6IGZsZXg7XG4gIGhlaWdodDogJHtwcm9wcyA9PiBwcm9wcy50aGVtZS5zZWNvbmRhcnlJbnB1dEhlaWdodH07XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGZvbnQtc2l6ZTogMTFweDtcbiAganVzdGlmeS1jb250ZW50OiAke3Byb3BzID0+IHByb3BzLmlzRW5sYXJnZWQgPyAnY2VudGVyJyA6ICdzcGFjZS1iZXR3ZWVuJ307XG4gIGNvbG9yOiAke3Byb3BzID0+IHByb3BzLnRoZW1lLmxhYmVsQ29sb3J9O1xuXG4gIC5ob3Jpem9udGFsLWJhciB7XG4gICAgcGFkZGluZzogMCAxMnB4O1xuICB9XG5cbiAgLnRpbWUtdmFsdWUge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgZmxleC1kaXJlY3Rpb246ICR7cHJvcHMgPT4gcHJvcHMuaXNFbmxhcmdlZCA/ICdyb3cnIDogJ2NvbHVtbid9O1xuICAgIGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0O1xuICB9XG5cbiAgLnRpbWUtdmFsdWU6bGFzdC1jaGlsZCB7XG4gICAgYWxpZ24taXRlbXM6IGZsZXgtZW5kO1xuICB9XG5gO1xuXG5jb25zdCBUaW1lVGl0bGUgPSAoe3ZhbHVlLCBpc0VubGFyZ2VkLCB0aW1lRm9ybWF0ID0gZGVmYXVsdFRpbWVGb3JtYXR9KSA9PiAoXG4gIDxUaW1lVmFsdWVXcmFwcGVyIGlzRW5sYXJnZWQ9e2lzRW5sYXJnZWR9PlxuICAgIDxUaW1lVmFsdWUga2V5PXswfSB2YWx1ZT17bW9tZW50LnV0Yyh2YWx1ZVswXSkuZm9ybWF0KHRpbWVGb3JtYXQpfSBzcGxpdD17IWlzRW5sYXJnZWR9Lz5cbiAgICB7aXNFbmxhcmdlZCA/IChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiaG9yaXpvbnRhbC1iYXJcIj5cbiAgICAgICAgPE1pbnVzIGhlaWdodD1cIjEycHhcIi8+XG4gICAgICA8L2Rpdj5cbiAgICApIDogbnVsbH1cbiAgICA8VGltZVZhbHVlIGtleT17MX0gdmFsdWU9e21vbWVudC51dGModmFsdWVbMV0pLmZvcm1hdCh0aW1lRm9ybWF0KX0gc3BsaXQ9eyFpc0VubGFyZ2VkfS8+XG4gIDwvVGltZVZhbHVlV3JhcHBlcj5cbik7XG5cbmNvbnN0IFRpbWVWYWx1ZSA9ICh7dmFsdWUsIHNwbGl0fSkgPT4gKFxuICAvLyByZW5kZXIgdHdvIGxpbmVzIGlmIG5vdCBlbmxhcmdlZFxuICA8ZGl2IGNsYXNzTmFtZT1cInRpbWUtdmFsdWVcIj5cbiAgICB7c3BsaXQgPyB2YWx1ZS5zcGxpdCgnICcpLm1hcCgodiwgaSkgPT4gKFxuICAgICAgPGRpdiBrZXk9e2l9PlxuICAgICAgICB7aSA9PT0gMCA/IDxTZWxlY3RUZXh0Pnt2fTwvU2VsZWN0VGV4dD4gOlxuICAgICAgICA8U2VsZWN0VGV4dEJvbGQ+e3Z9PC9TZWxlY3RUZXh0Qm9sZD59XG4gICAgICA8L2Rpdj5cbiAgICApKSA6IDxTZWxlY3RUZXh0Qm9sZD57dmFsdWV9PC9TZWxlY3RUZXh0Qm9sZD59XG4gIDwvZGl2PlxuKTtcblxuY29uc3QgU3R5bGVkQW5pbWF0aW9uQ29udHJvbHMgPSBzdHlsZWQuZGl2YFxuICBtYXJnaW4tYm90dG9tOiAxMnB4O1xuICBtYXJnaW4tcmlnaHQ6IDQycHg7XG5cbiAgJi5kaXNhYmxlZCB7XG4gICAgb3BhY2l0eTogMC40O1xuICAgIHBvaW50ZXItZXZlbnRzOiBub25lO1xuICB9XG5gO1xuXG5jb25zdCBJY29uQnV0dG9uID0gQnV0dG9uLmV4dGVuZGBcbiAgc3ZnIHtcbiAgICBtYXJnaW46IDAgNnB4O1xuICB9XG5gO1xuXG5jb25zdCBBbmltYXRpb25Db250cm9scyA9ICh7XG4gIGlzQW5pbWF0YWJsZSxcbiAgaXNBbmltYXRpbmcsXG4gIHBhdXNlQW5pbWF0aW9uLFxuICByZXNldEFuaW1hdGlvbixcbiAgc3RhcnRBbmltYXRpb25cbn0pID0+IChcbiAgPFN0eWxlZEFuaW1hdGlvbkNvbnRyb2xzXG4gICAgY2xhc3NOYW1lPXtjbGFzc25hbWVzKCd0aW1lLXJhbmdlLXNsaWRlcl9fY29udHJvbCcsIHtkaXNhYmxlZDogIWlzQW5pbWF0YWJsZX0pfVxuICA+XG4gICAgPEJ1dHRvbkdyb3VwPlxuICAgICAgPEljb25CdXR0b24gY2xhc3NOYW1lPVwicGxheWJhY2stY29udHJvbC1idXR0b25cIlxuICAgICAgICBvbkNsaWNrPXtyZXNldEFuaW1hdGlvbn0gc2Vjb25kYXJ5PlxuICAgICAgICA8UmVzZXQgaGVpZ2h0PVwiMTJweFwiLz5cbiAgICAgIDwvSWNvbkJ1dHRvbj5cbiAgICAgIDxJY29uQnV0dG9uIGNsYXNzTmFtZT17Y2xhc3NuYW1lcygncGxheWJhY2stY29udHJvbC1idXR0b24nLCB7YWN0aXZlOiBpc0FuaW1hdGluZ30pfVxuICAgICAgICBvbkNsaWNrPXtpc0FuaW1hdGluZyA/IHBhdXNlQW5pbWF0aW9uIDogc3RhcnRBbmltYXRpb259IHNlY29uZGFyeT5cbiAgICAgICAge2lzQW5pbWF0aW5nID8gPFBhdXNlIGhlaWdodD1cIjEycHhcIi8+IDogPFBsYXkgaGVpZ2h0PVwiMTJweFwiLz59XG4gICAgICA8L0ljb25CdXR0b24+XG4gICAgPC9CdXR0b25Hcm91cD5cbiAgPC9TdHlsZWRBbmltYXRpb25Db250cm9scz5cbik7XG4iXX0=